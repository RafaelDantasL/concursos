<!-- Formulário de captura de nome e e-mail -->
<form id="email-form" action="https://script.google.com/macros/s/AKfycbyaNWUWUqY6bMWKxLDsR78s7yJThP86QzrDPUY0QNDM0LQd1xBNkJoJBJ5x7PJCT_w/exec" method="POST" onsubmit="handleSubmit(event)" novalidate>
  <label for="name">Insira seu nome:</label>
  <input type="text" id="name" name="name" required /><br />
  <label for="email">Insira seu e-mail (apenas Gmail):</label>
  <input type="email" id="email" name="email" required /><br />
  <input type="submit" value="Enviar" />
</form>
<p id="response"></p>

<script>
  // Função para submeter o formulário e enviar os dados para o Google Sheets
  function handleSubmit(event) {
    event.preventDefault();
    
    var form = event.target;
    var responseElem = document.getElementById("response");
    responseElem.innerText = "Enviando...";

    var formData = new FormData(form);
    var name = formData.get('name');
    var email = formData.get('email');

    // Validação dos dados
    if (!validateForm(name, email)) {
      responseElem.innerText = 'Erro: Dados inválidos. Por favor, verifique seu nome e e-mail.';
      return;
    }

    // Enviar os dados para o Google Sheets via Google Apps Script
    fetch(form.action, {
      method: form.method,
      body: formData
    })
    .then(response => response.text())
    .then(text => {
      responseElem.innerText = "Enviado com sucesso!";
      localStorage.setItem('name', name);
      localStorage.setItem('email', email);
      form.reset(); // Limpar o formulário após o envio

      // Recarregar a página após um curto período
      setTimeout(function() {
        window.location.reload();
      }, 1000); 
    })
    .catch(error => responseElem.innerText = 'Erro: ' + error);
  }

  // Função para validar o nome e e-mail
  function validateForm(name, email) {
    var gmailPattern = /^[a-zA-Z0-9._%+-]+@gmail.com$/;
    if (name.trim() === "" || !gmailPattern.test(email)) {
      return false;
    }
    return true;
  }
</script>
